{% extends "EdukodasTemplateBundle::base.html.twig" %}

{% block main %}
    {% if is_granted('ROLE_TEACHER') %}
        {% include "EdukodasTemplateBundle:Profile/inc:_modalStructure.html.twig" %}
        {% include '@EdukodasTemplate/Profile/inc/_pointHistoryModal.html.twig' with {
            'courses': teacher.courses,
            'form': addPointsForm
        } %}
        {% include '@EdukodasTemplate/Profile/inc/_editPointHistoryModal.html.twig' %}
    {% endif %}

    <div class="container">
        <div class="row" style="clear: both;">
            {# Student info #}
            <div class="row">
                <div class="col s12">
                    <div class="card">
                        <div class="card-content">
                            <span class="card-title">
                                {{ user.fullName }} <small>({{ user.studentClass.title }})</small>
                                {% if app.user.id == user.id %}
                                    <a class="btn-floating btn-small waves-effect waves-light red"
                                       href="{{ path('fos_user_profile_edit') }}">
                                       <i class="small material-icons">edit</i>
                                    </a>
                                {% endif %}
                            </span>
                            {% if user.studentTeam.title is defined %}
                                <p>{{ user.studentTeam.title }} komanda</p>
                            {% endif %}
                            <p>Taškų suma: {{ points | number_format }}</p>

                            <ul class="collection with-header">
                                <li class="collection-header"><h4>Reitingas</h4></li>
                                <li class="collection-item">Kartoje: <b>#</b></li>
                                <li class="collection-item">Komandoje: <b>#</b></li>
                                <li class="collection-item">Mokykloje: <b>#</b></li>
                                <li class="collection-item">Klasėje: <b>#</b></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>

            {# Point history #}
            <div class="row">
                <div class="col s12">
                    <h5>{{ 'profile.heading.points_history'|trans }}</h5>

                    {% if is_granted('ROLE_TEACHER') %}
                        <a class="btn-floating btn-small waves-effect waves-light red"
                           id="edukodas_points_add"
                           data-points-action="edukodas_points_add"
                           data-user-id="{{ user.id }}"
                           href="#manage-points-modal">
                            <i class="small material-icons">library_add</i>
                        </a>
                    {% endif %}

                    <div class="section">
                        <ul class="collection" id="points-history-list">
                            {% for pointHistoryEntry in pointHistory %}
                                {# @var pointHistoryEntry \Edukodas\Bundle\StatisticsBundle\Entity\PointHistory #}
                                {% include "EdukodasTemplateBundle:pointhistory:listpoints.html.twig" with {
                                entryId: pointHistoryEntry.id,
                                amount: pointHistoryEntry.amount,
                                studentName: pointHistoryEntry.student.fullName,
                                teacherName: pointHistoryEntry.teacher.fullName,
                                taskName: pointHistoryEntry.task.name,
                                comment: pointHistoryEntry.comment,
                                createdAt: pointHistoryEntry.createdAt|date('Y/m/d H:m')
                                } %}
                            {% else %}
                                {{ 'profile.point_history.no_entries'|trans }}
                            {% endfor %}
                        </ul>
                    </div>

                </div>
            </div>
        </div>
    </div>
{% endblock %}
